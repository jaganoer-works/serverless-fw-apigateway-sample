## はじめに

Azureのリソースグループを手動で一つずつ削除する作業は、特に学習目的で多数のリソースを扱った後には非常に面倒です。そのため、一括でリソースグループを削除するスクリプトを用意しました。


> [!CAUTION]
> このスクリプトは本番環境では絶対に使用しないでください。学習目的の環境のみで使用すること

## 前提条件

- **Azure CLIのインストール**: スクリプトを実行するためには、Azure CLIが必要です。まだインストールしていない場合は、Azureの公式サイトからダウンロードしてインストールしてください。
- **Bash環境の確保**: スクリプトはBashで書かれています。Linux, macOS, WSL、Git Bashなど、Bashが利用可能な環境で実行してください。

## スクリプトの使用方法

### スクリプトの準備

テキストエディタを開き、以下のスクリプトをコピー＆ペーストしてください。ファイル名はとします。

```bash
#!/bin/bash

echo "警告: この操作により、現在のAzureサブスクリプションの全てのリソースグループが永久に削除されます。"
echo "本番環境では絶対に実行しないでください。"

read -p "本当に全てのAzureリソースグループを削除しますか？[y/N]: " answer
case $answer in
  [Yy]* )
    for rg in $(az group list --query "[].name" -o tsv)
    do
      echo "削除するリソースグループ: $rg"
      if ! az group delete --name $rg --yes --no-wait; then
        echo "エラー: リソースグループ '$rg' の削除に失敗しました。"
        exit 1
      fi
    done
    echo "リソースグループの削除を開始しました。"
    ;;
  * )
    echo "操作はキャンセルされました。"
    ;;
esac

```

### 実行権限の付与

スクリプトを保存した後、ターミナルを開き、以下のコマンドを使用してスクリプトに実行権限を付与します。

```bash
chmod +x delete-azure-rg.sh

```

### スクリプトの実行

実行権限を付与したら、以下のコマンドでスクリプトを実行します。

```bash
./delete-azure-rg.sh

```

この時、全てのAzureリソースグループを削除するかどうかの確認メッセージが表示されます。削除を進める場合は`y`を、キャンセルする場合は`n`を入力してください。

## 注意事項

このスクリプトを実行する際は、以下の点に十分注意してください。

1. **本番環境での使用禁止**
    
    このスクリプトは、学習目的の環境でのみ使用してください。本番環境で誤って実行すると、取り返しのつかない事態になる可能性があります。
    
2. **削除対象の確認**
    
    スクリプトを実行する前に、現在のAzureサブスクリプションに含まれるリソースグループを確認しておきましょう。意図しないリソースグループが削除されないよう、十分に注意が必要です。
    
3. **削除の確認プロンプト**
    
    スクリプトの実行時には、全てのリソースグループを削除するかどうかの確認メッセージが表示されます。よく確認してから`y`を入力するようにしてください。
    
4. **削除の取り消し不可**
    
    一度削除したリソースグループは元に戻せません。重要なリソースを誤って削除しないよう、細心の注意を払ってください。
    
5. **エラーへの対処**
    
    リソースグループの削除に失敗した場合、スクリプトはエラーメッセージを表示して終了します。エラーが発生した場合は、手動でリソースグループを確認し、問題を解決する必要があります。
